<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <p>提交实习申请后发来个小测验，给我做崩溃了，第一个要我做这种级别的SQL，我最多也就会个 <code>select from where</code>，超纲过于严重，只能回头补习</p> <p><span id="more"></span>&lt;h2 id="Data-Type"&gt;<a href="#Data-Type" class="headerlink" title="Data Type"></a>Data Type&lt;/h2&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;名称&lt;/th&gt;&lt;th&gt;类型&lt;/th&gt;&lt;th&gt;说明&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;INT&lt;/td&gt;&lt;td&gt;整型&lt;/td&gt;&lt;td&gt;4字节整数类型，范围约+/-21亿&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;长整型&lt;/td&gt;&lt;td&gt;8字节整数类型，范围约+/-922亿亿&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;REAL&lt;/td&gt;&lt;td&gt;浮点型&lt;/td&gt;&lt;td&gt;4字节浮点数，范围约+/-1038&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;DOUBLE&lt;/td&gt;&lt;td&gt;浮点型&lt;/td&gt;&lt;td&gt;8字节浮点数，范围约+/-10308&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;DECIMAL(M,N)&lt;/td&gt;&lt;td&gt;高精度小数&lt;/td&gt;&lt;td&gt;由用户指定精度的小数，例如，DECIMAL(20,10)表示一共20位，其中小数10位，通常用于财务计算&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;CHAR(N)&lt;/td&gt;&lt;td&gt;定长字符串&lt;/td&gt;&lt;td&gt;存储指定长度的字符串，例如，CHAR(100)总是存储100个字符的字符串&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;VARCHAR(N)&lt;/td&gt;&lt;td&gt;变长字符串&lt;/td&gt;&lt;td&gt;存储可变长度的字符串，例如，VARCHAR(100)可以存储0~100个字符的字符串&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;BOOLEAN&lt;/td&gt;&lt;td&gt;布尔类型&lt;/td&gt;&lt;td&gt;存储True或者False&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;DATE&lt;/td&gt;&lt;td&gt;日期类型&lt;/td&gt;&lt;td&gt;存储日期，例如，2018-06-22&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;TIME&lt;/td&gt;&lt;td&gt;时间类型&lt;/td&gt;&lt;td&gt;存储时间，例如，12:20:59&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;DATETIME&lt;/td&gt;&lt;td&gt;日期和时间类型&lt;/td&gt;&lt;td&gt;存储日期+时间，例如，2018-06-22 12:20:59&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;h2 id="Table-Constraints"&gt;<a href="#Table-Constraints" class="headerlink" title="Table Constraints"></a>Table Constraints&lt;/h2&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Constraint&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;<code>PRIMARY KEY</code>&lt;/td&gt;&lt;td&gt;This means that the values in this column are unique, and each value can be used to identify a single row in this table.&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;<code>AUTOINCREMENT</code>&lt;/td&gt;&lt;td&gt;For integer values, this means that the value is automatically filled in and incremented with each row insertion. Not supported in all databases.&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;<code>UNIQUE</code>&lt;/td&gt;&lt;td&gt;This means that the values in this column have to be unique, so you can’t insert another row with the same value in this column as another row in the table. Differs from the <code>PRIMARY KEY</code> in that it doesn’t have to be a key for a row in the table.&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;<code>NOT NULL</code>&lt;/td&gt;&lt;td&gt;This means that the inserted value can not be <code>NULL</code>.&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;<code>CHECK (expression)</code>&lt;/td&gt;&lt;td&gt;This allows you to run a more complex expression to test whether the values inserted are valid. For example, you can check that values are positive, or greater than a specific size, or start with a certain prefix, etc.&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;<code>FOREIGN KEY</code>&lt;/td&gt;&lt;td&gt;This is a consistency check which ensures that each value in this column corresponds to another value in a column in another table. For example, if there are two tables, one listing all Employees by ID, and another listing their payroll information, the <code>FOREIGN KEY</code> can ensure that every row in the payroll table corresponds to a valid employee in the master Employee list.&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;h2 id="Table-Structure"&gt;<a href="#Table-Structure" class="headerlink" title="Table Structure"></a>Table Structure&lt;/h2&gt;&lt;h3 id="Foreign-Key"&gt;<a href="#Foreign-Key" class="headerlink" title="Foreign Key"></a>Foreign Key&lt;/h3&gt;&lt;p&gt;A foreign key is a field (or collection of fields) in one table, that refers to the primary key in another table.&lt;/p&gt;&lt;p&gt;The foreign key constraint prevents invalid data from being inserted into the foreign key column, because it has to be one of the values contained in the parent table.&lt;/p&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> students </span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_class_id <span class="comment">– name the constraint</span></span><br><span class="line"><span class="keyword">FOREIGN</span> KEY (class_id) <span class="comment">– use class_id column in students as FK</span></span><br><span class="line"><span class="keyword">REFERENCES</span> classes (id); <span class="comment">– links to id in table classes</span></span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;p&gt;Deleting the constraint won’t delete the column used as FK. &lt;/p&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> students</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> KEY fk_class_id;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h3 id="Indexing"&gt;<a href="#Indexing" class="headerlink" title="Indexing"></a>Indexing&lt;/h3&gt;&lt;p&gt;We can index frequently accessed columns to speed up querying. Indexes are based on hash, so the more spread out the data in index columns are, the better indexing performs. 索引的效率取决于索引列的值是否散列，即该列的值如果越互不相同，那么索引效率越高。反过来，如果记录的列存在大量相同的值，例如<code>gender</code>列，大约一半的记录值是<code>M</code>，另一半是<code>F</code>，因此，对该列创建索引就没有意义。&lt;/p&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> students</span><br><span class="line"><span class="keyword">ADD</span> INDEX idx_score (score); <span class="comment">– indexing named as idx_score; it indexes column score </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> students</span><br><span class="line"><span class="keyword">ADD</span> INDEX idx_name_score (name, score); <span class="comment">– create a two-column indexing of name and score</span></span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h3 id="Unique"&gt;<a href="#Unique" class="headerlink" title="Unique"></a>Unique&lt;/h3&gt;&lt;p&gt;Add a <code>UNIQUE</code> constraint to make sure the uniqueness of student’s name (Assume no two students have the same name).&lt;/p&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> students</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> uni_name <span class="keyword">UNIQUE</span> (name);</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h2 id="Querying-Table"&gt;<a href="#Querying-Table" class="headerlink" title="Querying Table"></a>Querying Table&lt;/h2&gt;&lt;p&gt;注意字符串用的都是单引号 <code>' '</code>. &lt;/p&gt;&lt;h3 id="Conditionals"&gt;<a href="#Conditionals" class="headerlink" title="Conditionals"></a>Conditionals&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;<code>=</code>: equal&lt;/li&gt;&lt;li&gt;<code>&lt;&gt;</code>: not equal&lt;/li&gt;&lt;li&gt;<code>LIKE</code>: case insensitive exact string comparison;&lt;ul&gt;&lt;li&gt; <code>%</code> is wildcard. <code>'ab%'</code> matches ‘ab’，’abc’，’abcd’ &lt;/li&gt;&lt;li&gt;<code>_</code> is “appeared once”. <code>LIKE "ab_"</code> matches “abc”, but not “ab” or “abcd”&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;<code>BETWEEN … AND …</code>: number is within range of two values (inclusive). e.g. <code>col_name BETWEEN 1.5 AND 10.5</code>&lt;/li&gt;&lt;li&gt;<code>IN (…)</code>: number exists in a list. e.g. <code>col_name IN (2, 4, 6)</code>&lt;/li&gt;&lt;li&gt;<code>NOT …</code>: to negate a predicate&lt;/li&gt;&lt;/ul&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="comment">– sometimes we don't need FROM</span></span><br><span class="line"><span class="comment">– this is usually used to test connection to data base</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span> <span class="operator">+</span> <span class="number">200</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> students <span class="keyword">WHERE</span> (score <span class="operator">&lt;</span> <span class="number">80</span> <span class="keyword">OR</span> score <span class="operator">&gt;</span> <span class="number">90</span>) <span class="keyword">AND</span> gender <span class="operator">=</span> <span class="string">'M'</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> students <span class="keyword">WHERE</span> (<span class="keyword">NOT</span> class_id <span class="operator">&lt;&gt;</span> <span class="number">2</span>) <span class="keyword">AND</span> score <span class="keyword">LIKE</span> <span class="string">'8%'</span> ;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h3 id="Projections"&gt;<a href="#Projections" class="headerlink" title="Projections"></a>Projections&lt;/h3&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="comment">– rename column score as points</span></span><br><span class="line"><span class="keyword">SELECT</span> id, score points, name <span class="keyword">FROM</span> students;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h3 id="Orders"&gt;<a href="#Orders" class="headerlink" title="Orders"></a>Orders&lt;/h3&gt;&lt;p&gt;Query results are usually ordered by PK. If we want to change the order, we can &lt;/p&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="comment">– order by score (default in ascending order 正序)</span></span><br><span class="line"><span class="keyword">SELECT</span> id, name, score <span class="keyword">FROM</span> students <span class="keyword">ORDER</span> <span class="keyword">BY</span> score;</span><br><span class="line"></span><br><span class="line"><span class="comment">– order by score and gender (descending score and ascending id)</span></span><br><span class="line"><span class="keyword">SELECT</span> id, name, score <span class="keyword">FROM</span> students <span class="keyword">ORDER</span> <span class="keyword">BY</span> score <span class="keyword">DESC</span>, id;</span><br><span class="line"></span><br><span class="line"><span class="comment">– together with WHERE</span></span><br><span class="line"><span class="keyword">SELECT</span> id, name, gender, score</span><br><span class="line"><span class="keyword">FROM</span> students</span><br><span class="line"><span class="keyword">WHERE</span> class_id <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> score <span class="keyword">DESC</span>;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h3 id="Partial-Results"&gt;<a href="#Partial-Results" class="headerlink" title="Partial Results"></a>Partial Results&lt;/h3&gt;&lt;p&gt;Query result is sometimes in huge amount. In this case, we only want to show part of the result.&lt;/p&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="comment">– show only 3 result</span></span><br><span class="line"><span class="keyword">SELECT</span> id, name, gender, score <span class="keyword">FROM</span> students <span class="keyword">ORDER</span> <span class="keyword">BY</span> score <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">– show only 3 result, starting from the 7th.</span></span><br><span class="line"><span class="keyword">SELECT</span> id, name, gender, score <span class="keyword">FROM</span> students <span class="keyword">ORDER</span> <span class="keyword">BY</span> score <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">3</span> <span class="keyword">OFFSET</span> <span class="number">6</span>;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h3 id="Groups"&gt;<a href="#Groups" class="headerlink" title="Groups"></a>Groups&lt;/h3&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="comment">– return #records in TABLE students, and name it num</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) num <span class="keyword">FROM</span> students;</span><br><span class="line"></span><br><span class="line"><span class="comment">– return #records whose gender is 'M', and name the result "boys"</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) boys <span class="keyword">FROM</span> students <span class="keyword">WHERE</span> gender <span class="operator">=</span> <span class="string">'M'</span>;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;p&gt;和 <code>COUNT</code> 类似的还有以下函数：&lt;/p&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;函数&lt;/th&gt;&lt;th&gt;说明&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;SUM&lt;/td&gt;&lt;td&gt;计算某一列的合计值，该列必须为数值类型&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;AVG&lt;/td&gt;&lt;td&gt;计算某一列的平均值，该列必须为数值类型&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;MAX&lt;/td&gt;&lt;td&gt;计算某一列的最大值，如果是字符串类型则返回排序最后的字符&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;MIN&lt;/td&gt;&lt;td&gt;计算某一列的最小值，如果是字符串类型则返回排序最前的字符&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;其中，如果 <code>WHERE</code> 条件没有匹配到任何行，<code>COUNT()</code>会返回0，而<code>SUM()</code>、<code>AVG()</code>、<code>MAX()</code>和<code>MIN()</code>会返回<code>NULL</code>。&lt;/p&gt;&lt;p&gt;分完组后，我们不能再用 <code>WHERE</code> 对组进行筛选，以组为级别进行筛选需要 <code>HAVING</code>. &lt;/p&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="comment">– 按照 class_id 分组(class_id=1, 2, 3, … 各一组)， 分别返回每一组的总记录数</span></span><br><span class="line"><span class="keyword">SELECT</span> class_id, <span class="built_in">COUNT</span>(<span class="operator">*</span>) num <span class="keyword">FROM</span> students <span class="keyword">GROUP</span> <span class="keyword">BY</span> class_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">– 分完组后，</span></span><br><span class="line"><span class="keyword">SELECT</span> class_id, <span class="built_in">COUNT</span>(<span class="operator">*</span>) num <span class="keyword">FROM</span> students <span class="keyword">GROUP</span> <span class="keyword">BY</span> class_id <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">&gt;</span> <span class="number">36</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">– 对于像 name 这种在一个组内并不是相同的值，会返回 NULL / 报错</span></span><br><span class="line"><span class="comment">– 因此对于聚合查询，我们只能放入聚合查询的 col 名或者一些其他的聚合函数</span></span><br><span class="line"><span class="keyword">SELECT</span> name, class_id, <span class="built_in">COUNT</span>(<span class="operator">*</span>) num <span class="keyword">FROM</span> students <span class="keyword">GROUP</span> <span class="keyword">BY</span> class_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">– 查询每个班级男女分别的平均分</span></span><br><span class="line"><span class="keyword">SELECT</span> class_id, gender, <span class="built_in">AVG</span>(score) <span class="keyword">FROM</span> students </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> gender, class_id <span class="keyword">ORDER</span> <span class="keyword">BY</span> class_id, gender;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h3 id="Multiple-Tables"&gt;<a href="#Multiple-Tables" class="headerlink" title="Multiple Tables"></a>Multiple Tables&lt;/h3&gt;&lt;p&gt;When you select from more than one table, database will return the Cartesian product of the results. &lt;/p&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="keyword">SELECT</span></span><br><span class="line"> s.id sid, s.name, s.gender, s.score,</span><br><span class="line"> c.id cid, c.name cname</span><br><span class="line"><span class="keyword">FROM</span> students s, classes c</span><br><span class="line"><span class="keyword">WHERE</span> s.gender <span class="operator">=</span> <span class="string">'M'</span> <span class="keyword">AND</span> c.id <span class="operator">=</span> <span class="number">1</span>;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h3 id="Join"&gt;<a href="#Join" class="headerlink" title="Join"></a>Join&lt;/h3&gt;&lt;p&gt;与前文的 <em>Multiple Tables</em> 不同的是，<em>Multiple Tables</em> 把所有结果先调出来再根据结果进行筛选，效率很慢；而我们的 <code>JOIN</code> 可以&lt;/p&gt;&lt;ul&gt;&lt;li&gt;<code>INNER JOIN</code>只返回同时存在于两张表的行数据。比如<code>students</code>表的<code>class_id</code>包含1，2，3，<code>classes</code>表的<code>id</code>包含1，2，3，4，所以，INNER JOIN根据条件<code>s.class_id = c.id</code>返回的结果集仅包含1，2，3。&lt;/li&gt;&lt;li&gt;<code>RIGHT OUTER JOIN</code>返回右表都存在的行。如果某一行仅在右表存在，那么结果集就会以<code>NULL</code>填充剩下的字段。&lt;/li&gt;&lt;li&gt;<code>LEFT OUTER JOIN</code>则返回左表都存在的行。如果我们给students表增加一行，并添加class_id=5，由于classes表并不存在id=5的行，所以，LEFT OUTER JOIN的结果会增加一行，对应的<code>class_name</code>是<code>NULL</code>：&lt;/li&gt;&lt;li&gt;<code>FULL OUTER JOIN</code>，它会把两张表的所有记录全部选择出来，并且，自动把对方不存在的列填充为NULL：&lt;/li&gt;&lt;/ul&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="comment">– Join 指令模板</span></span><br><span class="line"><span class="keyword">SELECT</span> … <span class="keyword">FROM</span> tableA ??? <span class="keyword">JOIN</span> tableB <span class="keyword">ON</span> tableA.column1 <span class="operator">=</span> tableB.column2;</span><br><span class="line"></span><br><span class="line"><span class="comment">– 上文使用的例子对应的指令</span></span><br><span class="line"><span class="keyword">SELECT</span> s.id, s.name, s.class_id, c.name class_name, s.gender, s.score</span><br><span class="line"><span class="keyword">FROM</span> students s</span><br><span class="line"><span class="keyword">FULL</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> classes c</span><br><span class="line"><span class="keyword">ON</span> s.class_id <span class="operator">=</span> c.id;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;p&gt;<img src="https://dataschool.com/assets/images/how-to-teach-people-sql/sqlJoins/sqlJoins_7.png" alt="Join in Graphs">&lt;/p&gt;&lt;h3 id="Null"&gt;<a href="#Null" class="headerlink" title="Null"></a>Null&lt;/h3&gt;&lt;p&gt;An alternative to <code>NULL</code> values in your database is to have <em>data-type appropriate default values</em>, like 0 for numerical data, empty strings for text data, etc. But if your database needs to store incomplete data, then <code>NULL</code> values can be appropriate if the default values will skew later analysis (for example, when taking averages of numerical data).&lt;/p&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="comment">– select all non-null values</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">column</span>, another_column, … <span class="keyword">FROM</span> mytable</span><br><span class="line"><span class="keyword">WHERE</span> column_name <span class="keyword">IS</span><span class="operator">/</span><span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h2 id="Operating-on-Rows"&gt;<a href="#Operating-on-Rows" class="headerlink" title="Operating on Rows"></a>Operating on Rows&lt;/h2&gt;&lt;h3 id="Insert"&gt;<a href="#Insert" class="headerlink" title="Insert"></a>Insert&lt;/h3&gt;&lt;p&gt;When we insert something into the table, we don’t have to specify value of the primary key column. Because the primary key is automatically calculated by the database. &lt;/p&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name (col1, col2, …) </span><br><span class="line"><span class="keyword">VALUES</span> (v1, v2, …)</span><br><span class="line"> (v1, v2, …);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> students (class_id, name, gender, score) <span class="keyword">VALUES</span></span><br><span class="line"> (<span class="number">1</span>, <span class="string">'大宝'</span>, <span class="string">'M'</span>, <span class="number">87</span>),</span><br><span class="line"> (<span class="number">2</span>, <span class="string">'二宝'</span>, <span class="string">'M'</span>, <span class="number">81</span>);</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h3 id="Update"&gt;<a href="#Update" class="headerlink" title="Update"></a>Update&lt;/h3&gt;&lt;p&gt;We can update a record in the table.&lt;/p&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line">UPDATE table_name <span class="keyword">SET</span> col1<span class="operator">=</span>v1, col2<span class="operator">=</span>v2, … <span class="keyword">WHERE</span> …;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">– update a single record</span></span><br><span class="line">UPDATE students <span class="keyword">SET</span> name<span class="operator">=</span><span class="string">'大牛'</span>, score<span class="operator">=</span><span class="number">66</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">– update multiple records</span></span><br><span class="line">UPDATE students <span class="keyword">SET</span> name<span class="operator">=</span><span class="string">'小牛'</span>, score<span class="operator">=</span><span class="number">77</span> <span class="keyword">WHERE</span> id<span class="operator">&gt;=</span><span class="number">5</span> <span class="keyword">AND</span> id<span class="operator">&lt;=</span><span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">– add 10 points to all scores below 80</span></span><br><span class="line">UPDATE students <span class="keyword">SET</span> score<span class="operator">=</span>score<span class="operator">+</span><span class="number">10</span> <span class="keyword">WHERE</span> score<span class="operator">&lt;</span><span class="number">80</span>;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h3 id="Delete"&gt;<a href="#Delete" class="headerlink" title="Delete"></a>Delete&lt;/h3&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> …;</span><br><span class="line"></span><br><span class="line"><span class="comment">– delete multiple records </span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> students <span class="keyword">WHERE</span> id<span class="operator">&gt;=</span><span class="number">5</span> <span class="keyword">AND</span> id<span class="operator">&lt;=</span><span class="number">7</span>;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h2 id="Operating-on-Table"&gt;<a href="#Operating-on-Table" class="headerlink" title="Operating on Table"></a>Operating on Table&lt;/h2&gt;&lt;h3 id="Create-Table"&gt;<a href="#Create-Table" class="headerlink" title="Create Table"></a>Create Table&lt;/h3&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> table_name ( </span><br><span class="line"> column_name <span class="operator">*</span>DataType<span class="operator">*</span> <span class="operator">*</span>TableConstraint<span class="operator">*</span> <span class="keyword">DEFAULT</span> <span class="operator">*</span>default_value<span class="operator">*</span>, </span><br><span class="line"> another_column_name <span class="operator">*</span>DataType<span class="operator">*</span> <span class="operator">*</span>TableConstraint<span class="operator">*</span> <span class="keyword">DEFAULT</span> <span class="operator">*</span>default_value<span class="operator">*</span>, </span><br><span class="line"> … );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Movies <span class="keyword">table</span> schema</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> movies (</span><br><span class="line"> id <span class="type">INTEGER</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line"> title TEXT,</span><br><span class="line"> director TEXT,</span><br><span class="line"> <span class="keyword">year</span> <span class="type">INTEGER</span></span><br><span class="line">);</span><br><span class="line"></span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h3 id="Alter-Table"&gt;<a href="#Alter-Table" class="headerlink" title="Alter Table"></a>Alter Table&lt;/h3&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="comment">– add a column to table</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> mytable </span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">column</span> <span class="operator">*</span>DataType<span class="operator">*</span> <span class="operator">*</span>OptionalTableConstraint<span class="operator">*</span> <span class="keyword">DEFAULT</span> default_value;</span><br><span class="line"></span><br><span class="line"><span class="comment">– remove a column from table</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> mytable</span><br><span class="line"><span class="keyword">DROP</span> column_to_be_deleted;</span><br><span class="line"></span><br><span class="line"><span class="comment">– renaming the table</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> mytable</span><br><span class="line">RENAME <span class="keyword">TO</span> new_table_name;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h3 id="Delete-Table"&gt;<a href="#Delete-Table" class="headerlink" title="Delete Table"></a>Delete Table&lt;/h3&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> mytable;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h2 id="Others"&gt;<a href="#Others" class="headerlink" title="Others"></a>Others&lt;/h2&gt;&lt;h3 id="View"&gt;<a href="#View" class="headerlink" title="View"></a>View&lt;/h3&gt;<figure class="highlight sql">&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;<span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;<span class="line"><span class="keyword">create</span> <span class="keyword">view</span> current_demographic_dim</span><br><span class="line">(current_demographic_key, current_salary_range, current_age_range)</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> demographic_key, salary_range, age_range</span><br><span class="line"><span class="keyword">from</span> SAMPLES.DEMOGRAPHIC_DIM;</span><br>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</figure>&lt;h3 id="实用SQL语句"&gt;<a href="#%E5%AE%9E%E7%94%A8SQL%E8%AF%AD%E5%8F%A5" class="headerlink" title="实用SQL语句"></a><a href="https://www.liaoxuefeng.com/wiki/1177760294764384/1246617682185952" rel="external nofollow noopener" target="_blank">实用SQL语句</a>&lt;/h3&gt;&lt;h2 id="Reference"&gt;<a href="#Reference" class="headerlink" title="Reference"></a>Reference&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;<a href="https://www.liaoxuefeng.com/wiki/1177760294764384" rel="external nofollow noopener" target="_blank">廖雪峰的SQL教程</a>&lt;/li&gt;&lt;li&gt;<a href="https://sqlbolt.com/" rel="external nofollow noopener" target="_blank">SQLBolt</a>&lt;/li&gt;&lt;/ol&gt;</p> </body></html>